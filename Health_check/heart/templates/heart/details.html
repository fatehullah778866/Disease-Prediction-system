{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Disease Dataset Report</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
    <!-- PapaParse for CSV parsing -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4fc3f7;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --danger-color: #e63946;
            --success-color: #2a9d8f;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark-color);
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .card {
            margin-bottom: 2rem;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.25);
            transform: translateY(-5px);
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            font-weight: 600;
            border-radius: 15px 15px 0 0 !important;
        }

        .chart-container {
            height: 400px;
            width: 100%;
            margin-bottom: 1.5rem;
        }

        canvas {
            max-height: 400px;
            width: 100%;
        }

        table {
            width: 100%;
            margin-bottom: 1rem;
            color: var(--dark-color);
        }

        table th, table td {
            padding: 0.75rem;
            vertical-align: top;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        table thead th {
            vertical-align: bottom;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
            background: rgba(255, 255, 255, 0.7);
        }

        table tbody tr:nth-of-type(odd) {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .loading-spinner {
            display: none; /* Hide spinner by default */
        }

        .spinner-border {
            width: 3rem;
            height: 3rem;
            border: 8px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        .insight-item {
            margin-bottom: 0.5rem;
        }

        .scroll-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: none;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 20px;
            z-index: 99;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .scroll-to-top:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .back-home-btn {
            background-color: var(--primary-color);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            color: white;
            width: 100%;
            text-align: center;
            display: block;
            margin-bottom: 2rem;
        }

        .back-home-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            color: white;
            text-decoration: none;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .card {
                padding: 1.5rem;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div id="root">
            <div class="loading-spinner">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div>
    </div>
    
    <button onclick="topFunction()" id="scrollToTopBtn" class="scroll-to-top" title="Go to top">â†‘</button>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Define the home URL for JavaScript -->
    <script>
        const homeUrl = "{% url 'heart:heart_home' %}";
    </script>

    {% verbatim %}
    <script>
        // Main application
        document.addEventListener('DOMContentLoaded', function() {
            // Load data and render the page
            loadData();
            
            // Scroll to top button functionality
            window.onscroll = function() {
                scrollFunction();
            };
        });

        function scrollFunction() {
            const scrollToTopBtn = document.getElementById("scrollToTopBtn");
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                scrollToTopBtn.style.display = "block";
            } else {
                scrollToTopBtn.style.display = "none";
            }
        }

        function topFunction() {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        }

        // Process and clean data
        function processAndCleanData(rawData) {
            return rawData
                .filter(row => row['patientid'] && row['target'] !== '') // Discard empty/invalid rows
                .map(row => {
                    const cleaned = {};
                    Object.keys(row).forEach(key => {
                        let value = row[key];
                        // Convert numeric fields
                        const numericFields = ['age', 'restingBP', 'serumcholestrol', 'maxheartrate', 'oldpeak', 'noofmajorvessels'];
                        if (numericFields.includes(key)) {
                            value = parseFloat(value);
                            if (isNaN(value)) value = null;
                        }
                        // Convert binary/categorical fields
                        const categoricalFields = ['gender', 'chestpain', 'fastingbloodsugar', 'restingrelectro', 'exerciseangia', 'slope', 'target'];
                        if (categoricalFields.includes(key)) {
                            value = parseInt(value, 10);
                            if (isNaN(value)) value = null;
                        }
                        cleaned[key] = value;
                    });
                    return cleaned;
                })
                .filter(row => row['target'] !== null); // Ensure valid target
        }

        // Data preparation functions
        function prepareAgeDistribution(data) {
            const bins = Array(8).fill(0); // 10-year bins from 20 to 100
            data.forEach(row => {
                const age = row['age'];
                if (age && age >= 20 && age <= 100) {
                    const binIndex = Math.floor((age - 20) / 10);
                    bins[binIndex]++;
                }
            });
            return bins.map((count, index) => ({
                ageRange: `${20 + index * 10}-${20 + (index + 1) * 10}`,
                count
            }));
        }

        function prepareGenderHeartDisease(data) {
            const counts = { Male: { Disease: 0, NoDisease: 0 }, Female: { Disease: 0, NoDisease: 0 } };
            data.forEach(row => {
                const gender = row['gender'] === 1 ? 'Male' : 'Female';
                const diagnosis = row['target'] === 1 ? 'Disease' : 'NoDisease';
                counts[gender][diagnosis]++;
            });
            return [
                { name: 'Male', Disease: counts.Male.Disease, NoDisease: counts.Male.NoDisease },
                { name: 'Female', Disease: counts.Female.Disease, NoDisease: counts.Female.NoDisease }
            ];
        }

        function prepareBPvsCholesterol(data) {
            // Sampling up to 200 points for performance
            const sampled = data
                .filter(row => row['restingBP'] && row['serumcholestrol'])
                .slice(0, 200);
            return sampled.map(row => ({
                restingBP: row['restingBP'],
                serumcholestrol: row['serumcholestrol'],
                Diagnosis: row['target'] === 1 ? 'Heart Disease' : 'No Heart Disease'
            }));
        }

        function prepareChestPainTypes(data) {
            const types = {
                0: 'Typical Angina',
                1: 'Atypical Angina',
                2: 'Non-anginal Pain',
                3: 'Asymptomatic'
            };
            const counts = {};
            data.forEach(row => {
                const type = row['chestpain'];
                if (type !== null && type !== undefined) {
                    const typeName = types[type] || 'Unknown';
                    if (!counts[typeName]) counts[typeName] = 0;
                    counts[typeName]++;
                }
            });
            return Object.keys(counts).map(type => ({
                type,
                count: counts[type]
            }));
        }

        function prepareMaxHeartRateByAge(data) {
            const bins = {};
            data.forEach(row => {
                const age = row['age'];
                const rate = row['maxheartrate'];
                if (age && rate) {
                    const bin = Math.floor(age / 10) * 10;
                    if (!bins[bin]) bins[bin] = { sum: 0, count: 0 };
                    bins[bin].sum += rate;
                    bins[bin].count++;
                }
            });
            return Object.keys(bins)
                .map(bin => ({
                    age: parseInt(bin),
                    averageRate: bins[bin].sum / bins[bin].count
                }))
                .sort((a, b) => a.age - b.age);
        }

        // Render charts using Chart.js
        function renderAgeDistributionChart(ageData) {
            const ctx = document.getElementById('ageDistributionChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ageData.map(d => d.ageRange),
                    datasets: [{
                        label: 'Number of Patients',
                        data: ageData.map(d => d.count),
                        backgroundColor: '#ef5350',
                        borderColor: '#ef5350',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Age Range (Years)',
                                font: { size: 12 }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Number of Patients',
                                font: { size: 12 }
                            },
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: { display: true },
                        tooltip: { enabled: true }
                    }
                }
            });
        }

        function renderGenderHeartDiseaseChart(genderData) {
            const ctx = document.getElementById('genderHeartDiseaseChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: genderData.map(d => d.name),
                    datasets: [
                        {
                            label: 'Heart Disease',
                            data: genderData.map(d => d.Disease),
                            backgroundColor: '#ef5350',
                            borderColor: '#ef5350',
                            borderWidth: 1
                        },
                        {
                            label: 'No Heart Disease',
                            data: genderData.map(d => d.NoDisease),
                            backgroundColor: '#4db6ac',
                            borderColor: '#4db6ac',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Gender',
                                font: { size: 12 }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Number of Patients',
                                font: { size: 12 }
                            },
                            beginAtZero: true,
                            stacked: true
                        }
                    },
                    plugins: {
                        legend: { display: true },
                        tooltip: { enabled: true }
                    }
                }
            });
        }

        function renderBPvsCholesterolChart(bpCholData) {
            const ctx = document.getElementById('bpCholChart').getContext('2d');
            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Heart Disease',
                            data: bpCholData.filter(d => d.Diagnosis === 'Heart Disease').map(d => ({
                                x: d.serumcholestrol,
                                y: d.restingBP
                            })),
                            backgroundColor: '#ef5350',
                            pointRadius: 4
                        },
                        {
                            label: 'No Heart Disease',
                            data: bpCholData.filter(d => d.Diagnosis === 'No Heart Disease').map(d => ({
                                x: d.serumcholestrol,
                                y: d.restingBP
                            })),
                            backgroundColor: '#4db6ac',
                            pointRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Serum Cholesterol (mg/dL)',
                                font: { size: 12 }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Resting Blood Pressure (mm Hg)',
                                font: { size: 12 }
                            }
                        }
                    },
                    plugins: {
                        legend: { display: true },
                        tooltip: { enabled: true }
                    }
                }
            });
        }

        function renderChestPainTypesChart(chestPainData) {
            const ctx = document.getElementById('chestPainChart').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: chestPainData.map(d => d.type),
                    datasets: [{
                        data: chestPainData.map(d => d.count),
                        backgroundColor: [
                            '#ef5350',
                            '#ff7043',
                            '#ffee58',
                            '#4db6ac'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true },
                        tooltip: { enabled: true }
                    }
                }
            });
        }

        function renderMaxHeartRateByAgeChart(rateData) {
            const ctx = document.getElementById('heartRateAgeChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: rateData.map(d => d.age),
                    datasets: [{
                        label: 'Average Max Heart Rate',
                        data: rateData.map(d => d.averageRate),
                        borderColor: '#ef5350',
                        backgroundColor: 'rgba(239, 83, 80, 0.2)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Age (Years)',
                                font: { size: 12 }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Average Max Heart Rate (bpm)',
                                font: { size: 12 }
                            },
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: { display: true },
                        tooltip: { enabled: true }
                    }
                }
            });
        }

        // Load data and render the page
        function loadData() {
            // Simulate loading data (in a real app, fetch from a Django endpoint)
            setTimeout(() => {
                const sampleData = [
                    { patientid: "103368", age: "53", gender: "1", chestpain: "2", restingBP: "171", serumcholestrol: "0", fastingbloodsugar: "0", restingrelectro: "1", maxheartrate: "147", exerciseangia: "0", oldpeak: "5.3", slope: "3", noofmajorvessels: "3", target: "1" },
                    { patientid: "119250", age: "40", gender: "1", chestpain: "0", restingBP: "94", serumcholestrol: "229", fastingbloodsugar: "0", restingrelectro: "1", maxheartrate: "115", exerciseangia: "0", oldpeak: "3.7", slope: "1", noofmajorvessels: "1", target: "0" },
                    { patientid: "119372", age: "49", gender: "1", chestpain: "2", restingBP: "133", serumcholestrol: "142", fastingbloodsugar: "0", restingrelectro: "0", maxheartrate: "202", exerciseangia: "1", oldpeak: "5", slope: "1", noofmajorvessels: "0", target: "0" }
                ];
                
                const cleanedData = processAndCleanData(sampleData);
                renderPage(cleanedData);
            }, 1500);
        }

        // Render the complete page
        function renderPage(data) {
            const ageData = prepareAgeDistribution(data);
            const genderData = prepareGenderHeartDisease(data);
            const bpCholData = prepareBPvsCholesterol(data);
            const chestPainData = prepareChestPainTypes(data);
            const rateData = prepareMaxHeartRateByAge(data);

            const root = document.getElementById('root');
            root.innerHTML = `
                <div class="container my-4">
                    <!-- Header Section -->
                    <header class="header text-center mb-5">
                        <h1 class="display-4 fw-bold mb-3">Heart Disease Dataset Report</h1>
                        <p class="lead">
                            A comprehensive analysis of the Heart Disease dataset, featuring patient demographics, clinical measurements, and risk factors for heart disease prediction.
                        </p>
                    </header>

                    <!-- Summary Section -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="h4 mb-0">Dataset Summary</h2>
                        </div>
                        <div class="card-body">
                            <p class="card-text mb-3">
                                The Heart Disease dataset contains <strong>1,025 patient records</strong> with <strong>14 attributes</strong>, designed for predicting heart disease presence. It includes:
                            </p>
                            <ul class="mb-3">
                                <li>Demographic information (e.g., Age, Gender).</li>
                                <li>Clinical measurements (e.g., Blood Pressure, Cholesterol, Heart Rate).</li>
                                <li>Symptom information (e.g., Chest Pain Type, Exercise Induced Angina).</li>
                                <li>Electrocardiographic results (e.g., Resting ECG, ST Depression).</li>
                                <li>Outcome variable: Target (0 = No Heart Disease, 1 = Heart Disease).</li>
                            </ul>
                            <p class="card-text">
                                This dataset is ideal for machine learning models to predict heart disease risk and understand contributing factors.
                            </p>
                        </div>
                    </div>

                    <!-- Column Descriptions -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="h4 mb-0">Column Descriptions</h2>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Column Name</th>
                                            <th>Description</th>
                                            <th>Data Type</th>
                                            <th>Example Value</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>patientid</td><td>Unique identifier for each patient</td><td>Integer</td><td>103368</td></tr>
                                        <tr><td>age</td><td>Patient's age in years</td><td>Integer</td><td>53</td></tr>
                                        <tr><td>gender</td><td>1 = Male, 0 = Female</td><td>Binary</td><td>1</td></tr>
                                        <tr><td>chestpain</td><td>Chest pain type (0-3):<br>0 = Typical angina<br>1 = Atypical angina<br>2 = Non-anginal pain<br>3 = Asymptomatic</td><td>Categorical</td><td>2</td></tr>
                                        <tr><td>restingBP</td><td>Resting blood pressure (mm Hg)</td><td>Integer</td><td>171</td></tr>
                                        <tr><td>serumcholestrol</td><td>Serum cholesterol (mg/dL)</td><td>Integer</td><td>229</td></tr>
                                        <tr><td>fastingbloodsugar</td><td>Fasting blood sugar > 120 mg/dL (1 = true; 0 = false)</td><td>Binary</td><td>0</td></tr>
                                        <tr><td>restingrelectro</td><td>Resting electrocardiographic results (0-2):<br>0 = Normal<br>1 = ST-T wave abnormality<br>2 = Left ventricular hypertrophy</td><td>Categorical</td><td>1</td></tr>
                                        <tr><td>maxheartrate</td><td>Maximum heart rate achieved</td><td>Integer</td><td>147</td></tr>
                                        <tr><td>exerciseangia</td><td>Exercise induced angina (1 = yes; 0 = no)</td><td>Binary</td><td>0</td></tr>
                                        <tr><td>oldpeak</td><td>ST depression induced by exercise relative to rest</td><td>Float</td><td>5.3</td></tr>
                                        <tr><td>slope</td><td>Slope of the peak exercise ST segment (0-3):<br>0 = Upsloping<br>1 = Flat<br>2 = Downsloping<br>3 = Biphasic</td><td>Categorical</td><td>3</td></tr>
                                        <tr><td>noofmajorvessels</td><td>Number of major vessels (0-3) colored by fluoroscopy</td><td>Integer</td><td>3</td></tr>
                                        <tr><td>target</td><td>Heart disease diagnosis (0 = No, 1 = Yes)</td><td>Binary</td><td>1</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Visualizations Section -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="h4 mb-0">Visualizations</h2>
                        </div>
                        <div class="card-body">
                            <!-- Age Distribution -->
                            <div class="mb-5">
                                <h3 class="h5 fw-bold mb-2">Age Distribution of Patients</h3>
                                <p class="text-muted mb-3">This chart shows the distribution of patient ages, binned into 10-year intervals.</p>
                                <div class="chart-container">
                                    <canvas id="ageDistributionChart"></canvas>
                                </div>
                            </div>

                            <!-- Heart Disease Prevalence by Gender -->
                            <div class="mb-5">
                                <h3 class="h5 fw-bold mb-2">Heart Disease Prevalence by Gender</h3>
                                <p class="text-muted mb-3">This chart compares heart disease diagnosis rates between male and female patients.</p>
                                <div class="chart-container">
                                    <canvas id="genderHeartDiseaseChart"></canvas>
                                </div>
                            </div>

                            <!-- Blood Pressure vs. Cholesterol -->
                            <div class="mb-5">
                                <h3 class="h5 fw-bold mb-2">Blood Pressure vs. Cholesterol</h3>
                                <p class="text-muted mb-3">This scatter plot explores the relationship between blood pressure and cholesterol, colored by heart disease diagnosis.</p>
                                <div class="chart-container">
                                    <canvas id="bpCholChart"></canvas>
                                </div>
                            </div>

                            <!-- Chest Pain Types -->
                            <div class="mb-5">
                                <h3 class="h5 fw-bold mb-2">Distribution of Chest Pain Types</h3>
                                <p class="text-muted mb-3">This pie chart shows the prevalence of different types of chest pain reported by patients.</p>
                                <div class="chart-container">
                                    <canvas id="chestPainChart"></canvas>
                                </div>
                            </div>

                            <!-- Max Heart Rate by Age -->
                            <div class="mb-3">
                                <h3 class="h5 fw-bold mb-2">Maximum Heart Rate by Age</h3>
                                <p class="text-muted mb-3">This line chart shows average maximum heart rate achieved during exercise across age groups.</p>
                                <div class="chart-container">
                                    <canvas id="heartRateAgeChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Key Insights -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="h4 mb-0">Key Insights</h2>
                        </div>
                        <div class="card-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item insight-item">The dataset shows a higher prevalence of heart disease in males compared to females, with approximately 55% of male patients diagnosed with heart disease versus 25% of female patients.</li>
                                <li class="list-group-item insight-item">Patients with asymptomatic chest pain (type 3) have the highest likelihood of heart disease, despite not reporting typical angina symptoms.</li>
                                <li class="list-group-item insight-item">Higher blood pressure (>140 mm Hg) and cholesterol levels (>240 mg/dL) are strongly associated with heart disease, as seen in the scatter plot.</li>
                                <li class="list-group-item insight-item">Maximum heart rate achieved during exercise tends to decrease with age, following the expected physiological pattern.</li>
                                <li class="list-group-item insight-item">Patients with more major vessels colored by fluoroscopy (indicating blockages) have a higher prevalence of heart disease.</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Conclusion -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="h4 mb-0">Conclusion</h2>
                        </div>
                        <div class="card-body">
                            <p class="card-text">
                                The Heart Disease dataset provides valuable insights into the factors contributing to cardiovascular disease. Its comprehensive clinical attributes enable detailed analysis of disease mechanisms and risk factors. The visualizations reveal key patterns, such as the gender disparity in heart disease prevalence and the strong correlation between asymptomatic chest pain and disease presence. This dataset is particularly valuable for developing predictive models to identify at-risk patients and for clinical decision support in cardiology.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Back to Home Button -->
                    <a href="${homeUrl}" class="back-home-btn">Back to Home</a>
                </div>
            `;

            // Render all charts
            renderAgeDistributionChart(ageData);
            renderGenderHeartDiseaseChart(genderData);
            renderBPvsCholesterolChart(bpCholData);
            renderChestPainTypesChart(chestPainData);
            renderMaxHeartRateByAgeChart(rateData);
        }
    </script>
    {% endverbatim %}
</body>
</html>